const query = require('common/query')
const runner = require('common/db/runner')

const table = `authentication`
const columns = [ `authentication_id`, `username`, `password`, `expires` ]

module.exports = (connection) => {
	return {
		load: (params, cb) => {
			query(connection)
				.select(columns)
				.from(table)
				.where(`username`, params.username)
				.where(`password`, params.password)
				.whereAfter(`expires`, new Date())
				.build()
				.execute(cb)
		}
	}
}
